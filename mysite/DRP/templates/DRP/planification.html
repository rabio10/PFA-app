{% extends 'DRP/DRP_app.html' %}
{% block content2 %}
<!-- Nav tabs -->
<ul class="nav nav-tabs " id="myTab" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Dépôts</button>
  </li>
  <li class="nav-item" role="presentation">
  <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Entrepôt Central</button>
  </li>
  
  <!--unused tabs-->
  <!--
  <li class="nav-item" role="presentation">
  <button class="nav-link" id="messages-tab" data-bs-toggle="tab" data-bs-target="#messages" type="button" role="tab" aria-controls="messages" aria-selected="false">Messages</button>
  </li>
  <li class="nav-item" role="presentation">
  <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab" aria-controls="settings" aria-selected="false">Settings</button>
  </li>
  -->
</ul>
<script>
  fetch('{{ dic_prevision_total_json|safe }}')
  .then(response => response.text())
  .then((responseText) => {
    if (!responseText) {
      throw new Error('Empty server response');
    }
  })

  .then(data => {
    // Use the parsed data
    window.dicPlanningDepot = data;
  })
  .catch(error => {
    console.error('Error:', error);
  });
</script>
<!-- Tab panes -->
<div class="tab-content">
  <div class="tab-pane active" id="home" role="tabpanel" aria-labelledby="home-tab" tabindex="0">
    <!--tab2-->
    <div class="container mt-2">
      <h5 class="text-center p-2 border-bottom">Page de Planification des dépôts</h5>
      <!--form for trimester selection-->
      <form id="trimesterForm" class="form-inline row g-2">
        <div class="row p-1">
          <div class="col">
            <label class="my-1 mr-0 float-end text-center justify-content-center" for="trimesterDepotSelect">Choisir la Trimester:</label>
          </div>
          <div class="col-lg-7">
            <select class="form-select my-1 mx-0 mr-sm-2 float-start " id="trimesterDepotSelect" style="width: 50%;">
              <option value="1">Trimester 1 (Semaines 1-13)</option>
              <option value="2">Trimester 2 (Semaines 14-26)</option>
              <option value="3">Trimester 3 (Semaines 27-39)</option>
              <option value="4">Trimester 4 (Semaines 40-52)</option>
            </select>
          </div>
          <div class="col">
            <a href="{% url 'download_planning_depot' %}" class="btn btn-success" type="submit">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
              </svg>
              Télécharger les données</a>
          </div>
        </div>
      </form>
      <!--form for depot selecting-->
      
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-lg-6">
              <form action="" method="POST">
                {% csrf_token %}
                {{ form.as_p }}

                <input type="submit" value="Afficher Dépôt" class="btn btn-success">
              </form>
            </div>
            <div class="col-lg-2">
            </div>
            <div class="col-lg-2">
            </div>
          </div>
        </div>
      
    
      <table class="table table-bordered table-striped trimester-table px-5">
        <thead>
          <tr>
            <th>Numéro de Semaine</th>
            <th>Prévision</th>
            <th>Quantité de Stock</th>
            <th>Quantité de Commande</th>
          </tr>
        </thead>
        <tbody>
          <!-- Data will be populated here -->
           {% for row in planning %}
          <tr>
            <td>{{ row.semaine }}</td>
            <td>{{ row.prevision }}</td>
            <td>{{ row.stock }}</td>
            <td>{{ row.commandes }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    
    <!--end tab2-->
  </div>
  <div class="tab-pane" id="profile" role="tabpanel" aria-labelledby="home-tab" tabindex="1">
    <!--tab1-->
    <div class="container mt-2">
      <h5 class="text-center p-2 border-bottom">Page de Planification d'entrepôt central</h5>
      <form id="trimesterForm" class="form-inline row g-2">
        <div class="row p-1">
          <div class="col">
            <label class="my-1 mr-0 float-end text-center justify-content-center" for="trimesterSelect">Choisir la Trimester:</label>
          </div>
          <div class="col-lg-7">
            <select class="form-select my-1 mx-0 mr-sm-2 float-start " id="trimesterSelect" style="width: 50%;">
              <option value="1">Trimester 1 (Semaines 1-13)</option>
              <option value="2">Trimester 2 (Semaines 14-26)</option>
              <option value="3">Trimester 3 (Semaines 27-39)</option>
              <option value="4">Trimester 4 (Semaines 40-52)</option>
            </select>
          </div>
          <div class="col">
            <a href="{% url 'download_planning_total' %}" class="btn btn-success" type="submit">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
              </svg>
              Télécharger les données</a>
          </div>
        </div>
        
      </form>
    
      <table class="table table-bordered table-striped trimester-table px-5">
        <thead>
          <tr>
            <th>Numéro de Semaine</th>
            <th>Prévision</th>
            <th>Quantité de Stock</th>
            <th>Quantité de Commande</th>
          </tr>
        </thead>
        <!--<tbody id="tableBody"> -->
        <tbody>
          <!-- Data will be populated here -->
          {% for row in planning_entrepot %}
          <tr>
            <td>{{ row.semaine }}</td>
            <td>{{ row.prevision }}</td>
            <td>{{ row.stock }}</td>
            <td>{{ row.commandes }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <!--end tab1-->
  </div>
</div>


{% endblock %}